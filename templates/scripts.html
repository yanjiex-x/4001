{% extends 'base.html' %}

{% block head %}{% endblock %}

{% block body %}
  <h1>Mitigation Scripts</h1>

  <!-- Search list group -->
  <div class="search-list">
    <input type="text" id="search_list" onkeyup="search()" placeholder="Search for the app that needs to be updated or uninstalled">
    <ul id="app_list">
      <li><button class="listlinks" onclick="openDiv(event, 'Firefox')">Firefox<img src="{{ url_for('static', filename='css/1-square-fill.svg') }}" class="script_num" alt="1"></button/></li>
      <li><button class="listlinks" onclick="openDiv(event, 'MicrosoftApp')">Microsoft Applications<img src="{{ url_for('static', filename='css/2-square-fill.svg') }}" class="script_num" alt="2"></button></li>
      <li><button class="listlinks" onclick="openDiv(event, 'Chrome')">Google Chrome<img src="{{ url_for('static', filename='css/2-square-fill.svg') }}" class="script_num" alt="2"></button></li>
      <li><button class="listlinks" onclick="openDiv(event, 'AdobeFlash')">Adobe Flash Player<img src="{{ url_for('static', filename='css/1-square-fill.svg') }}" class="script_num" alt="1"></button></li>
    </ul>
  </div>

  <!-- Firefox -->
  <div class="listcontent" id="Firefox">
    <table>
      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/firefox.bat') }}" title="Click to download" download>firefox.bat</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>Batch script to update Mozilla Firefox to the latest version.</td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            <u>Command Prompt</u>
            <p id="command">firefox.bat</p>
          </div>
          <div>
            <u>PowerShell</u>
            <p id="command">./firefox.bat</p>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <!-- Microsoft Applications -->
  <div class="listcontent" id="MicrosoftApp">
    <table>
      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/microsoftapps.bat') }}" title="Click to download" download>microsoftapps.bat</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>
          Batch script to update all Microsoft applications.
          <div class="alert alert-primary">
            <img src="{{ url_for('static', filename='css/card-list.svg') }}" alt="card-list">  Note:
            <ul>
              <li><b>NOT</b> all applications can be updated.</li>
              <li>The <b>winget</b> tool is only supported on Windows 10 1709 and later. </li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            For first-time <b>winget</b> users, enter the following command before executing the downloaded script:
            <p id="command">winget upgrade</p>
          </div>
          <div>
            <u>Command Prompt</u>
            <p id="command">microsoftapps.bat</p>
          </div>
          <div>
            <u>PowerShell</u>
            <p id="command">./microsoftapps.bat</p>
          </div>
        </td>
      </tr>

      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/microsoftapps.ps1') }}" title="Click to download" download>microsoftapps.ps1</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>
          PowerShell script to update all Microsoft applications.
          <div class="alert alert-primary">
            <img src="{{ url_for('static', filename='css/card-list.svg') }}" alt="card-list">  Note:
            <ul>
              <li><b>NOT</b> all applications can be updated.</li>
              <li>The <b>winget</b> tool is only supported on Windows 10 1709 and later. </li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            For first-time <b>winget</b> users, enter the following command before executing the downloaded script:
            <p id="command">winget upgrade</p>
          </div>
          <div>
            <u>PowerShell</u>
            <p id="command">./microsoftapps.ps1</p>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <!-- Google Chrome -->
  <div class="listcontent" id="Chrome">
    <table>
      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/googleschrome.bat') }}" title="Click to download" download>googlechrome.bat</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>
          Batch script to update Google Chrome to the latest version.
          <div class="alert alert-primary">
            <img src="{{ url_for('static', filename='css/card-list.svg') }}" alt="card-list">
            Note: this script will trigger an error if Chrome was not opened prior to the execution of the script,
            but there is nothing to worry about it.
          </div>
        </td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            <u>Command Prompt</u>
            <p id="command">googlechrome.bat</p>
          </div>
          <div>
            <u>PowerShell</u>
            <p id="command">./googlechrome.bat</p>
          </div>
        </td>
      </tr>

      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/googleschrome.ps1') }}" title="Click to download" download>googlechrome.ps1</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>PowerShell script to update Google Chrome to the latest version.</td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            <u>PowerShell</u>
            <p id="command">./googlechrome.ps1</p>
          </div>
        </td>
      </tr>
    </table>
  </div>

  <!-- Adobe Flash Player -->
  <div class="listcontent" id="AdobeFlash">
    <table>
      <tr>
        <th>Script Name:</th>
        <td><a href="{{ url_for('static', filename='scripts/adobeflash.ps1') }}" title="Click to download" download>adobeflash.ps1</a></td>
      </tr>
      <tr>
        <th>Description:</th>
        <td>PowerShell script to uninstall Adobe Flash Player.</td>
      </tr>
      <tr>
        <th>Command(s):</th>
        <td>
          <div>
            <u>PowerShell</u>
            <p id="command">./adobeflash.ps1</p>
          </div>
        </td>
      </tr>
    </table>
  </div>

{% endblock %}
